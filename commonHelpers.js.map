{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst galleryGrid = document.querySelector('.gallery-grid');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.js-load-more-btn');\n\nlet gallery = new SimpleLightbox('.gallery-grid a', {\n  captionsData: 'alt',\n});\n\nform.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', handleLoadBtnClick);\n\nlet page = 1;\nlet inputValue;\nlet totalPages = 0;\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  hideLoadMoreBtn();\n\n  galleryGrid.innerHTML = '';\n\n  inputValue = event.target.elements.query.value.trim();\n\n  showLoader();\n\n  if (!inputValue) {\n    galleryGrid.innerHTML = '';\n    iziToast.error({\n      message: 'Search field is empty',\n      position: 'topRight',\n    });\n\n    hideLoader();\n    return;\n  }\n\n  try {\n    page = 1;\n    const data = await getImagesByInputValue();\n    if (data?.hits?.length) {\n      hideLoader();\n      totalPages = Math.ceil(data.totalHits / 15);\n      checkLoadBtnStatus();\n      createMarkupByHits(data.hits);\n\n      return;\n    }\n    throw Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  } catch (error) {\n    iziToast.info({\n      message:\n        typeof error === 'string' ? error : 'Something went wrong, sorry!',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n    // hideLoadMoreBtn();\n  }\n\n  event.target.reset();\n}\n\nasync function handleLoadBtnClick(event) {\n  showLoader();\n  hideLoadMoreBtn();\n\n  try {\n    page += 1;\n\n    const data = await getImagesByInputValue();\n    if (data?.hits?.length) {\n      hideLoader();\n      checkLoadBtnStatus();\n      createMarkupByHits(data.hits);\n      const cardHeight = document\n        .querySelector('.gallery-card')\n        .getBoundingClientRect().height;\n      scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n      return;\n    }\n    throw Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  } catch (error) {\n    iziToast.info({\n      message:\n        typeof error === 'string' ? error : 'Something went wrong, sorry!',\n      position: 'topRight',\n    });\n  }\n  event.target.reset();\n}\n\nfunction checkLoadBtnStatus() {\n  if (totalPages !== page) {\n    showLoadMoreBtn();\n  } else {\n    hideLoadMoreBtn();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n  }\n}\n\nfunction showLoader() {\n  loader.style.display = 'inline-block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.classList.remove('hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add('hidden');\n}\n\nasync function getImagesByInputValue() {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '42157668-d969611c6fdd34526589fe987',\n      q: inputValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safeSearch: true,\n      page: page,\n      per_page: 15,\n    },\n  });\n  return response.data;\n}\n\nfunction createMarkupByHits(hits) {\n  const galleryItem = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a href=\"${largeImageURL}\" class=\"gallery-card\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" >\n      <div class=\"img-details-box\">\n      <p class=\"detail-item\"><b>Likes:</b> ${likes}</p>\n      <p class=\"detail-item\"><b>Views:</b> ${views}</p>\n      <p class=\"detail-item\"><b>Comments:</b> ${comments}</p>\n      <p class=\"detail-item\"><b>Downloads:</b> ${downloads}</p></div>\n      </a>`;\n      }\n    )\n    .join('');\n\n  galleryGrid.insertAdjacentHTML('beforeend', galleryItem);\n\n  gallery.refresh();\n}\n"],"names":["form","galleryGrid","loader","loadMoreBtn","gallery","SimpleLightbox","handleFormSubmit","handleLoadBtnClick","page","inputValue","totalPages","event","hideLoadMoreBtn","showLoader","iziToast","hideLoader","data","getImagesByInputValue","_a","checkLoadBtnStatus","createMarkupByHits","error","cardHeight","showLoadMoreBtn","axios","hits","galleryItem","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}